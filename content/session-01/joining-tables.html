<div class="content-section">
    <div class="mb-8">
        <div class="flex items-center mb-4">
            <div class="w-3 h-8 bg-yellow-500 rounded-full mr-4"></div>
            <h2 class="text-3xl font-bold text-gray-900">Part 4: Joining Tables</h2>
        </div>
        <p class="text-lg text-gray-600 mb-6 leading-relaxed">This section focuses on how to combine information from multiple tables to build a more complete picture of events.</p>
    </div>
    
    <div>
        <h3 class="text-xl font-semibold mb-6 mt-8 text-gray-800">1. The <code class="text-lg">join</code> Operator</h3>
        <p class="mb-6">The <code class="bg-blue-50 text-blue-700 px-2 py-1 rounded-md font-mono text-sm">join</code> operator combines rows from two tables based on a matching key column. The most common types are <code class="bg-blue-50 text-blue-700 px-2 py-1 rounded-md font-mono text-sm">inner</code> (returns only matching rows) and <code class="bg-blue-50 text-blue-700 px-2 py-1 rounded-md font-mono text-sm">leftouter</code> (returns all rows from the left table, plus matches from the right).</p>
        <div class="code-block relative rounded-lg p-4 font-mono text-sm my-6">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors">Copy</button>
            </div>
            <pre><code><span class="kql-comment">// Find IT associate employees with failed logins</span>
<span class="kql-table">AuthenticationEvents</span>
<span class="kql-pipe">|</span> <span class="kql-keyword">where</span> result <span class="kql-pipe">==</span> <span class="kql-string">"Failed Login"</span>
<span class="kql-pipe">|</span> <span class="kql-keyword">join</span> kind<span class="kql-pipe">=</span>inner (
    <span class="kql-table">Employees</span>
    <span class="kql-pipe">|</span> <span class="kql-keyword">where</span> role <span class="kql-pipe">==</span> <span class="kql-string">"IT associate"</span>
) <span class="kql-keyword">on</span> username
<span class="kql-pipe">|</span> <span class="kql-keyword">project</span> timestamp, employee_name <span class="kql-pipe">=</span> name</code></pre>
        </div>
    </div>
    <div>
        <h3 class="text-xl font-semibold mb-6 mt-8 text-gray-800">2. Challenge: Joining Failed Logins with Employee Data</h3>
        <p class="mb-6">This challenge builds on our previous lessons. First, find the top 10 users with the most failed logins. Then, join that result with the <code class="bg-blue-50 text-blue-700 px-2 py-1 rounded-md font-mono text-sm">Employees</code> table to see their full name and role. This is a common security analysis task.</p>
        <div class="code-block relative rounded-lg p-4 font-mono text-sm my-6">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors">Copy</button>
            </div>
            <pre><code><span class="kql-table">AuthenticationEvents</span>
<span class="kql-pipe">|</span> <span class="kql-keyword">where</span> result <span class="kql-pipe">==</span> <span class="kql-string">"Failed Login"</span>
<span class="kql-pipe">|</span> <span class="kql-keyword">summarize</span> FailedAttempts <span class="kql-pipe">=</span> <span class="kql-function">count()</span> <span class="kql-keyword">by</span> username
<span class="kql-pipe">|</span> <span class="kql-keyword">top</span> 10 <span class="kql-keyword">by</span> FailedAttempts <span class="kql-keyword">desc</span>
<span class="kql-pipe">|</span> <span class="kql-keyword">join</span> kind<span class="kql-pipe">=</span>inner (<span class="kql-table">Employees</span>) <span class="kql-keyword">on</span> username
<span class="kql-pipe">|</span> <span class="kql-keyword">project</span> name, role, FailedAttempts</code></pre>
        </div>
    </div>
</div>