<div class="content-section">
    <div class="mb-8">
        <div class="flex items-center mb-4">
            <div class="w-3 h-8 bg-indigo-500 rounded-full mr-4"></div>
            <h2 class="text-3xl font-bold text-gray-900">Part 6: Challenge Queries</h2>
        </div>
        <p class="text-lg text-gray-600 mb-6 leading-relaxed">Now it's time to put everything together. These challenges require you to combine filtering, aggregation, and joining to find key insights in the data. Try to solve them yourself before revealing the solution.</p>
    </div>

    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 p-6 rounded-xl shadow-sm">
        <div class="flex items-center justify-between mb-2">
            <p class="font-semibold text-gray-800 text-lg">Challenge 1: Find the top 3 users with the most failed logins.</p>
            <span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Easy</span>
        </div>
    </div>
    <div class="flex gap-2 mt-4">
        <button id="hint-btn-1" class="bg-amber-500 text-white px-4 py-2 rounded-lg hover:bg-amber-600 transition-colors duration-200 font-medium shadow-sm">ðŸ’¡ Show Hint</button>
        <button id="solution-btn-1" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 font-medium shadow-sm">Show Solution</button>
    </div>
    <div id="hint-div-1" class="hidden mt-3 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg">
        <p class="text-amber-800"><strong>Hint:</strong> Use the <code>AuthenticationEvents</code> table and try using the <code>summarize count()</code> function. Think about which column contains login status information and how to identify unsuccessful attempts.</p>
    </div>
    <div id="solution-div-1" class="hidden mt-4">
        <div class="code-block relative rounded-lg p-4 font-mono text-sm shadow-sm">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors duration-200">Copy</button>
            </div>
            <pre><code>AuthenticationEvents
| where result == "Failed Login"
| summarize count() by username
| sort by count_ desc
| take 3</code></pre>
        </div>
        <div class="mt-3 bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-800 mb-2">Expected Results:</h4>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">username</th>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">count_</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr><td class="px-3 py-2 font-mono">jadenman</td><td class="px-3 py-2">22</td></tr>
                        <tr><td class="px-3 py-2 font-mono">rocampbell</td><td class="px-3 py-2">21</td></tr>
                        <tr><td class="px-3 py-2 font-mono">docannon</td><td class="px-3 py-2">20</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 p-6 rounded-xl shadow-sm mt-12">
        <div class="flex items-center justify-between mb-2">
            <p class="font-semibold text-gray-800 text-lg">Challenge 2: Find the top 10 IP addresses with the most authentication attempts.</p>
            <span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Easy</span>
        </div>
    </div>
    <div class="flex gap-2 mt-4">
        <button id="hint-btn-2" class="bg-amber-500 text-white px-4 py-2 rounded-lg hover:bg-amber-600 transition-colors duration-200 font-medium shadow-sm">ðŸ’¡ Show Hint</button>
        <button id="solution-btn-2" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium shadow-sm">Show Solution</button>
    </div>
    <div id="hint-div-2" class="hidden mt-3 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg">
        <p class="text-amber-800"><strong>Hint:</strong> Consider which table contains network information and what column represents the source of authentication attempts. Use aggregation functions to count occurrences and sorting to find the highest values.</p>
    </div>
    <div id="solution-div-2" class="hidden mt-4">
        <div class="code-block relative rounded-lg p-4 font-mono text-sm shadow-sm">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors duration-200">Copy</button>
            </div>
            <pre><code>AuthenticationEvents
| summarize Attempts = count() by src_ip
| top 10 by Attempts desc</code></pre>
        </div>
        <div class="mt-3 bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-800 mb-2">Expected Results:</h4>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">src_ip</th>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">Attempts</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr><td class="px-3 py-2 font-mono">88.150.11.111</td><td class="px-3 py-2">21</td></tr>
                        <tr><td class="px-3 py-2 font-mono">149.124.195.189</td><td class="px-3 py-2">15</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.2.188</td><td class="px-3 py-2">8</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.2.209</td><td class="px-3 py-2">8</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.0.172</td><td class="px-3 py-2">8</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.3.80</td><td class="px-3 py-2">7</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.2.13</td><td class="px-3 py-2">7</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.2.199</td><td class="px-3 py-2">7</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.0.179</td><td class="px-3 py-2">6</td></tr>
                        <tr><td class="px-3 py-2 font-mono">192.168.3.118</td><td class="px-3 py-2">6</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="bg-gradient-to-r from-purple-50 to-violet-50 border border-purple-200 p-6 rounded-xl shadow-sm mt-12">
        <div class="flex items-center justify-between mb-2">
            <p class="font-semibold text-gray-800 text-lg">Challenge 3: Find the top 10 users with the most failed logins and show their full name and role.</p>
            <span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Medium</span>
        </div>
    </div>
    <div class="flex gap-2 mt-4">
        <button id="hint-btn-3" class="bg-amber-500 text-white px-4 py-2 rounded-lg hover:bg-amber-600 transition-colors duration-200 font-medium shadow-sm">ðŸ’¡ Show Hint</button>
        <button id="solution-btn-3" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors duration-200 font-medium shadow-sm">Show Solution</button>
    </div>
    <div id="hint-div-3" class="hidden mt-3 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg">
        <p class="text-amber-800"><strong>Hint:</strong> This challenge requires combining data from multiple tables. Think about which table has authentication data and which has employee details. Consider how to connect related records between tables using common fields.</p>
    </div>
    <div id="solution-div-3" class="hidden mt-4">
        <div class="code-block relative rounded-lg p-4 font-mono text-sm shadow-sm">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors duration-200">Copy</button>
            </div>
            <pre><code>AuthenticationEvents
| where result == "Failed Login"
| summarize FailedAttempts = count() by username
| top 10 by FailedAttempts desc
| join kind=inner (Employees) on username
| project name, role, FailedAttempts</code></pre>
        </div>
        <div class="mt-3 bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-800 mb-2">Expected Results:</h4>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">name</th>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">role</th>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">FailedAttempts</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr><td class="px-3 py-2">Donna Cannon</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">20</td></tr>
                        <tr><td class="px-3 py-2">Kenneth Casas</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">15</td></tr>
                        <tr><td class="px-3 py-2">Marissa Stephens</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">14</td></tr>
                        <tr><td class="px-3 py-2">Tammy Turpin</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">15</td></tr>
                        <tr><td class="px-3 py-2">Rosario Campbell</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">21</td></tr>
                        <tr><td class="px-3 py-2">Kenneth Brashear</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">16</td></tr>
                        <tr><td class="px-3 py-2">Kenneth Fountain</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">13</td></tr>
                        <tr><td class="px-3 py-2">Melody Smith</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">15</td></tr>
                        <tr><td class="px-3 py-2">Micheal Hanson</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">18</td></tr>
                        <tr><td class="px-3 py-2">Janet Denman</td><td class="px-3 py-2">IT associate</td><td class="px-3 py-2">22</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 p-6 rounded-xl shadow-sm mt-12">
        <div class="flex items-center justify-between mb-2">
            <p class="font-semibold text-gray-800 text-lg">Challenge 4: Find the earliest and latest authentication event for each user.</p>
            <span class="px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full">Hard</span>
        </div>
    </div>
    <div class="flex gap-2 mt-4">
        <button id="hint-btn-4" class="bg-amber-500 text-white px-4 py-2 rounded-lg hover:bg-amber-600 transition-colors duration-200 font-medium shadow-sm">ðŸ’¡ Show Hint</button>
        <button id="solution-btn-4" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition-colors duration-200 font-medium shadow-sm">Show Solution</button>
    </div>
    <div id="hint-div-4" class="hidden mt-3 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg">
        <p class="text-amber-800"><strong>Hint:</strong> Think about functions that can find minimum and maximum values within groups. Consider the <code>arg_min()</code> and <code>arg_max()</code> functions with timing information and how to group data by user identity.</p>
    </div>
    <div id="solution-div-4" class="hidden mt-4">
        <div class="code-block relative rounded-lg p-4 font-mono text-sm shadow-sm">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors duration-200">Copy</button>
            </div>
            <pre><code>AuthenticationEvents
| summarize 
    earliest_event_timestamp = arg_min(timestamp, timestamp), 
    latest_event_timestamp = arg_max(timestamp, timestamp) 
    by username
| project username, earliest_event_timestamp, latest_event_timestamp
| take 10</code></pre>
        </div>
        <div class="mt-3 bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-800 mb-2">Expected Results:</h4>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">username</th>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">earliest_event_timestamp</th>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">latest_event_timestamp</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 text-xs">
                        <tr><td class="px-3 py-2 font-mono">jasaade</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:41.209621</td><td class="px-3 py-2 font-mono">2022-01-09 15:29:42.781887</td></tr>
                        <tr><td class="px-3 py-2 font-mono">marivera</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:46.650333</td><td class="px-3 py-2 font-mono">2022-01-09 15:35:05.750847</td></tr>
                        <tr><td class="px-3 py-2 font-mono">beparrish</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:47.110481</td><td class="px-3 py-2 font-mono">2022-01-09 15:37:30.060844</td></tr>
                        <tr><td class="px-3 py-2 font-mono">chricks</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:47.770901</td><td class="px-3 py-2 font-mono">2022-01-09 15:30:46.120167</td></tr>
                        <tr><td class="px-3 py-2 font-mono">yoopperman</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:52.281780</td><td class="px-3 py-2 font-mono">2022-01-10 13:51:35.510578</td></tr>
                        <tr><td class="px-3 py-2 font-mono">brburnett</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:52.641792</td><td class="px-3 py-2 font-mono">2022-01-07 17:01:29.409733</td></tr>
                        <tr><td class="px-3 py-2 font-mono">chhutchins</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:56.070251</td><td class="px-3 py-2 font-mono">2022-01-08 18:00:49.150372</td></tr>
                        <tr><td class="px-3 py-2 font-mono">minevills</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:56.511326</td><td class="px-3 py-2 font-mono">2022-01-08 18:00:35.801315</td></tr>
                        <tr><td class="px-3 py-2 font-mono">gicole</td><td class="px-3 py-2 font-mono">2022-01-03 19:23:59.861107</td><td class="px-3 py-2 font-mono">2022-01-04 20:25:53.939629</td></tr>
                        <tr><td class="px-3 py-2 font-mono">roallen</td><td class="px-3 py-2 font-mono">2022-01-03 19:24:00.221119</td><td class="px-3 py-2 font-mono">2022-01-10 13:44:41.251144</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 p-6 rounded-xl shadow-sm mt-12">
        <div class="flex items-center justify-between mb-2">
            <p class="font-semibold text-gray-800 text-lg">Challenge 5: Find the user with successful logins from China who also has successful logins from Russia.</p>
            <span class="px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full">Hard</span>
        </div>
    </div>
    <div class="flex gap-2 mt-4">
        <button id="hint-btn-5" class="bg-amber-500 text-white px-4 py-2 rounded-lg hover:bg-amber-600 transition-colors duration-200 font-medium shadow-sm">ðŸ’¡ Show Hint</button>
        <button id="solution-btn-5" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium shadow-sm">Show Solution</button>
    </div>
    <div id="hint-div-5" class="hidden mt-3 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg">
        <p class="text-amber-800"><strong>Hint:</strong> This challenge involves geographic analysis of IP addresses. Consider the <code>geo_info_from_ip_address()</code> function to extract location information, and think about how to find users who appear in multiple specific locations. You may need to use <code>let</code> statements for temporary variables.</p>
    </div>
    <div id="solution-div-5" class="hidden mt-4">
        <div class="code-block relative rounded-lg p-4 font-mono text-sm shadow-sm">
            <div class="flex space-x-2 absolute top-2 right-2">
                <button class="copy-btn bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs hover:bg-blue-200 transition-colors duration-200">Copy</button>
            </div>
            <pre><code>let C = AuthenticationEvents
| where not(ipv4_is_private(src_ip))
| extend timestamp = todatetime(timestamp)
| where isnotempty(src_ip)
    and result == "Successful Login"
| extend Location = geo_info_from_ip_address(src_ip)
| where Location contains "China"
| distinct username;
AuthenticationEvents
| where not(ipv4_is_private(src_ip))
| extend Location = geo_info_from_ip_address(src_ip)
| where username in (C) and Location contains "Russia"
| distinct username</code></pre>
        </div>
        <div class="mt-3 bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-800 mb-2">Expected Results:</h4>
            <div class="overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-3 py-2 text-left font-medium text-gray-700">username</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr><td class="px-3 py-2 font-mono">dukilcoyne</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>